{% extends "layout.html" %}

{% block content %}

	 <script>
	 	var currentRegion;
	 	var data = {
	 	    "Medulla": 
	 	   {"q1_1": "Pons",
	 		"q1_2": "Medulla",
	 		 "q1_3": "Mamillary Body",
	 		 "q2_1": "Regulates breathing and blood circulation",
	 		 "q2_2": "Has a role in motor movement",
	 		 "q2_3": "Stores episodic memories",
	 		 "q1_ans": "2",
	 		 "q2_ans": "1"},

	 	    "Pons": 
	 	    {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    
	 	    "Midbrain": 
	 	    {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},


	 	    "Mamillary Body": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Habenula": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Temporal Lobe (inferior surface)": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Hypothalamus": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Sub Callosal Gyrus": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Optic Chiasm": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Pituitary Gland": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Septal Nuclei": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Fornix": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Corpus Callosum": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Prefrontal Cortex": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Septum Pellucidum": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Massa Intermedia": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Motor Association Area": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Premotor Cortex": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Primary Motor Cortex": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Primary Somatosensory Cortex": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Somatosensory Association Area": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Cuneus": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Cingulate Gyrus": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Visual Association Area": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Third Ventricle": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Pineal Gland": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Superior Colliculus": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Inferior Colliculus": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Cerebral Aqueduct": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},


	 	    "Cerebellum": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Arbor Vitae": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Fourth Ventricle": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Visual Cortex": 
	 	       {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},

	 	    "Central Canal": 
	 	    {"q1_1": "",
	 		"q1_2": "",
	 		 "q1_3": "",
	 		 "q2_1": "",
	 		 "q2_2": "",
	 		 "q2_3": "",
	 		 "q1_ans": "",
	 		 "q2_ans": ""},
	 	}

	 	var quizQuestionsHTML = '<p id="quiz-q1">What is this the name of the selected region?</p><div id="quiz-q1-1-div" class="quiz-div"><input class="q1" type="radio" id="quiz-q1-1" name="q1" ><label id="quiz-q1-1-label" for= "quiz-q1-1"></label></div><div id="quiz-q1-2-div" class="quiz-div"><input class="q1" type="radio" id="quiz-q1-2"  name="q1" ><label id="quiz-q1-2-label" for= "quiz-q1-2"></label></div><div id="quiz-q1-3-div" class="quiz-div"><input class="q1" type="radio" id="quiz-q1-3" name="q1" ><label id="quiz-q1-3-label" for= "quiz-q1-3"></label></div><p id="quiz-q2">What is this the function of the selected region?</p>  <div id="quiz-q2-1-div" class="quiz-div"><input class="q2" type="radio" id="quiz-q2-1" name="q2" ><label id="quiz-q2-1-label" for= "quiz-q2-1"></label> </div><div id="quiz-q2-2-div" class="quiz-div"> <input class="q2" type="radio" id="quiz-q2-2" name="q2" ><label id="quiz-q2-2-label" for= "quiz-q2-2"></label> </div><div id="quiz-q2-3-div" class="quiz-div"><input class="q2" type="radio" id="quiz-q2-3" name="q2" ><label id="quiz-q2-3-label" for= "quiz-q2-3"></label></div>'

            $(document).ready(function(){

                 $('#brain').mapster({
                 fillOpacity: 0.4,               
                         stroke: true,
                         strokeColor: "000000",
                         strokeOpacity: 0.8,
                         strokeWidth: 2,
                         singleSelect: true,
                         mapKey: 'title',
                 wrapClass: 'brain-wrapper',
                 fillColor: 'd42e16',
              
                 onClick: function(e){
                 	  currentRegion = data[e.key]
                 	  backToNormal()
                 	  $("#quiz-questions-div").html(quizQuestionsHTML)
                      $('#quiz-q1-1-label').html(data[e.key].q1_1)
                      $('#quiz-q1-2-label').html(data[e.key].q1_2)
                      $('#quiz-q1-3-label').html(data[e.key].q1_3)
                      $('#quiz-q2-1-label').html(data[e.key].q2_1)
                      $('#quiz-q2-2-label').html(data[e.key].q2_2)
                      $('#quiz-q2-3-label').html(data[e.key].q2_3)
                 },
                 onMouseover: function (e) {
                  //if there is no area that is clicked
                   if  ($('#brain').mapster('get').length == 0){  
                   	  backToNormal()
                   	  currentRegion = data[e.key]
                   	  $("#quiz-questions-div").html(quizQuestionsHTML)
                      $('#quiz-q1-1-label').html(data[e.key].q1_1)
                      $('#quiz-q1-2-label').html(data[e.key].q1_2)
                      $('#quiz-q1-3-label').html(data[e.key].q1_3)
                      $('#quiz-q2-1-label').html(data[e.key].q2_1)
                      $('#quiz-q2-2-label').html(data[e.key].q2_2)
                      $('#quiz-q2-3-label').html(data[e.key].q2_3)
                   }      
                        }})})

            function backToNormal(){
            	$("i").remove()
            	$("#alert-div").html('')
            	$("#alert-div").removeClass()
            	$("#button-div").html('<button id="submit" class="btn btn-info" onclick="showResults()">Submit</button>')
            	$(".quiz-div").each(function(i,div){
            		$(div).css("background-color", "white")
            	})
            	$(".quiz-div input").each(function(i,input){
            		$(input).prop('checked', false)


            	})
            }

            function showResults(){

            	$("i").remove()

            	let score = 0;

            	let q1_answer = currentRegion.q1_ans
            	let q2_answer = currentRegion.q2_ans

            	let q1_correct_id = "#quiz-q1-" + q1_answer
            	let q2_correct_id = "#quiz-q2-" + q2_answer


            	$(".q1").each(function(i,input){

            		let curID = "#" + $(input).attr("id")
            		$(curID+"-div").css("background-color", "white")

            		if (input.checked){

            			if (curID == q1_correct_id){          				
            				$(curID+"-div").css("background-color", "#D4EDDA")
            				$(curID+"-div").prepend('<div class="icon-div"><i class="fas fa-check"></i></div>')
            				score += 1

            			} else{
            				$(curID+"-div").css("background-color", "#F8D7DA")
            				$(curID+"-div").prepend('<div class="icon-div"><i class="fas fa-times"></i></div>')
            			}

            		}
            	})

            	$(".q2").each(function(i,input){
            		let curID = "#" + $(input).attr("id")
            		$(curID+"-div").css("background-color", "white")

            		if (input.checked){

            			if (curID == q2_correct_id){
            				$(curID+"-div").css("background-color", "#D4EDDA")
            				$(curID+"-div").prepend('<div class="icon-div"><i class="fas fa-check"></i></div>')

            				score += 1

            			} else{
            				$(curID+"-div").css("background-color", "#F8D7DA")
            				$(curID+"-div").prepend('<div class="icon-div"><i class="fas fa-times"></i></div>')
            			}

            		}
            	})

            	let alertText = "Score: " + score + "/2"

            	$("#alert-div").hide()

            	$("#alert-div").html("<div id='score' class = 'alert' role='alert'></div>")

            	if (score < 2){
            		$("#alert-div").addClass("alert-danger")
            		if ($("#alert-div").hasClass("alert-success")){
            			$("#alert-div").removeClass("alert-success")
            		}
            		alertText += ". Try again!"
            	} else{
            		$("#alert-div").addClass("alert-success")
            		if ($("#alert-div").hasClass("alert-danger")){
            			$("#alert-div").removeClass("alert-danger")
            		}
            		alertText += ". Nice work!"
            		
            	}

            	$("#score").html(alertText)

            	$("#alert-div").fadeIn()




            }

        </script>

    <div id="quiz-content" class="container-fluid">
	    <div id="brain-div-container">      
	        <div id="title-div">
	          <p id="quiz-title">Click on a brain region to quiz yourself!</p>
	       </div>     
	        <div id="brain-div">   
	            <img id= "brain" class = "img-fluid" src= "{{url_for('static', filename = 'brain-detailed.jpg')}}" usemap="#image-map" alt="brain map" >
	        </div>
	        <div id= "brain-info-div">

	        	<div id="alert-div"></div>

	            <div id="quiz-questions-div"></div>
	              
	             <div id="button-div"> </div>
	        	  
	        </div>
	    </div>
	</div>
	





{% endblock %}